"use strict";(self.webpackChunkliterature_management_frontend=self.webpackChunkliterature_management_frontend||[]).push([[348],{3586:(t,e,r)=>{r.r(e),r.d(e,{scholarApi:()=>o});var a=r(7975);const o={scholarMirrors:["https://xueshu.lanfanshu.cn","https://ac.scmor.com","https://scholar.hedasudi.com","https://gg.xueshu5.com"],getRandomMirror:()=>{const t=o.scholarMirrors;return t[Math.floor(Math.random()*t.length)]},calculateSimilarity:(t,e)=>{if(!t||!e)return 0;const r=t.toLowerCase(),a=e.toLowerCase(),o=[];for(let n=0;n<=r.length;n++)o[n]=[n];for(let n=0;n<=a.length;n++)o[0][n]=n;for(let n=1;n<=r.length;n++)for(let t=1;t<=a.length;t++)r.charAt(n-1)===a.charAt(t-1)?o[n][t]=o[n-1][t-1]:o[n][t]=Math.min(o[n-1][t-1]+1,o[n][t-1]+1,o[n-1][t]+1);const l=Math.max(r.length,a.length);return 1-o[r.length][a.length]/l},searchPaper:async(t,e)=>{try{let r=`allintitle:${t}`;e&&(r+=` author:${e}`);const l=await a.FH.get("/api/search/scholar",{params:{q:r},timeout:3e4});return l.data&&l.data.results?(console.log("Search results:",l.data.results),l.data.results):l.data&&"string"===typeof l.data?o.parseSearchResults(l.data,t):(console.log("\u672a\u77e5\u683c\u5f0f\u7684\u641c\u7d22\u7ed3\u679c:",l.data),[])}catch(r){return console.error("Scholar search error:",r),[]}},parseSearchResults:(t,e)=>{const r=document.implementation.createHTMLDocument("temp");r.documentElement.innerHTML=t;const a=[],l=[".gs_ri",".gs_r.gs_or.gs_scl",".gs_or.gs_scl"];let n=null;for(const o of l)if(n=r.querySelectorAll(o),n&&n.length>0){console.log(`\u627e\u5230\u9009\u62e9\u5668 ${o} \u7684\u7ed3\u679c\uff1a${n.length}\u9879`);break}if(!n||0===n.length)return console.warn("\u65e0\u6cd5\u5728HTML\u4e2d\u627e\u5230\u8bba\u6587\u7ed3\u679c"),[];for(let s=0;s<n.length;s++){const t=n[s],r=o.extractPaperInfo(t,e);r&&a.push(r)}return a},extractPaperInfo:(t,e)=>{try{const r=t.querySelector(".gs_rt a, .gs_rti a")||t.querySelector("[data-lid]")||t.querySelector("h3 a");if(!r)return null;const l=(0,a.GX)(r.textContent).trim(),n=(0,a.GX)(r.getAttribute("href")),s=t.querySelector(".gs_rs")||t.querySelector(".gs_fl")||t.querySelector(".gs_snippet"),c=s?(0,a.GX)(s.textContent).trim():"",h=t.querySelector(".gs_a")||t.querySelector(".gs_fl"),u=h?(0,a.GX)(h.textContent).trim():"";let i="";const g=c.match(/10\.\d{4,9}\/[-._;()/:A-Z0-9]+/i)||u.match(/10\.\d{4,9}\/[-._;()/:A-Z0-9]+/i);if(g&&(i=g[0]),!i){const e=t.querySelectorAll("a");for(let t=0;t<e.length;t++){const r=(e[t].getAttribute("href")||"").match(/10\.\d{4,9}\/[-._;()/:A-Z0-9]+/i);if(r){i=r[0];break}}}o.calculateSimilarity(l,e);return{id:Math.random(),title:l,authors:[],year:0,journal:u,abstract:c,doi:i,url:n,source:"scholar"}}catch(r){return console.error("\u63d0\u53d6\u8bba\u6587\u4fe1\u606f\u65f6\u51fa\u9519:",r),null}},getProfile:async t=>(await a.FH.get(`/api/scholar/${t}`)).data}}}]);
//# sourceMappingURL=348.ed2e97ee.chunk.js.map